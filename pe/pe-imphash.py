#########################################################################################################
#                                                         
#                               /$$                         /$$                           /$$      
#                              |__/                        | $$                          | $$      
#   /$$$$$$   /$$$$$$          /$$ /$$$$$$/$$$$   /$$$$$$ | $$$$$$$   /$$$$$$   /$$$$$$$| $$$$$$$ 
#  /$$__  $$ /$$__  $$ /$$$$$$| $$| $$_  $$_  $$ /$$__  $$| $$__  $$ |____  $$ /$$_____/| $$__  $$
# | $$  \ $$| $$$$$$$$|______/| $$| $$ \ $$ \ $$| $$  \ $$| $$  \ $$  /$$$$$$$|  $$$$$$ | $$  \ $$
# | $$  | $$| $$_____/        | $$| $$ | $$ | $$| $$  | $$| $$  | $$ /$$__  $$ \____  $$| $$  | $$
# | $$$$$$$/|  $$$$$$$        | $$| $$ | $$ | $$| $$$$$$$/| $$  | $$|  $$$$$$$ /$$$$$$$/| $$  | $$
# | $$____/  \_______/        |__/|__/ |__/ |__/| $$____/ |__/  |__/ \_______/|_______/ |__/  |__/
# | $$                                          | $$                                              
# | $$                                          | $$                                              
# |__/                                          |__/                                                                                                                    
#                                                                         
# Creator: â’¸ 0xlay (https://github.com/0xlay)
#                                                             
# License: MIT
# 
# Description: The script generate hash for imports
#                                                                                                                                                    
#########################################################################################################

import pefile
import sys


def main():
    if len(sys.argv) < 2:
        print("Invalid arguments! Try again => <sample.exe>")
        return -1
    try:
        pe = pefile.PE(sys.argv[1])
        print(f'Import hash: {pe.get_imphash()}')
    except pefile.PEFormatError as err:
        print(f'Exception: {err}')


if __name__ == "__main__":
    main()
